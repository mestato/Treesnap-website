webpackJsonp([26],{"R/xA":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("U7vG"),l=a.n(n),r=a("F8kA"),o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={flags:[],page:0,per_page:10,total:0,has_more_pages:!1,loading:!0},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,n["Component"]),o(t,[{key:"componentDidMount",value:function(){this.loadFlags()}},{key:"loadFlags",value:function(){var e=this;this.setState({loading:!0}),axios.get("/admin/web/flags",{params:{page:this.state.page}}).then(function(t){var a=t.data.data;e.setState({flags:a.data,total:a.total,page:a.current_page,per_page:a.per_page,has_more_pages:null!==a.next_page_url,loading:!1}),window.scrollTo(0,0)}).catch(function(t){e.setState({loading:!1}),console.log(t)})}},{key:"next",value:function(){var e=this;this.state.has_more_pages&&this.setState({page:this.state.page+1},function(){console.log("going to page: ",e.state),e.loadFlags()})}},{key:"back",value:function(){var e=this;this.state.page<=1||this.setState({page:this.state.page-1},function(){e.loadFlags()})}},{key:"renderTable",value:function(){if(0!==this.state.total)return l.a.createElement("table",{className:"table"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Thumbnail"),l.a.createElement("th",{style:{width:"300px"}},"Observation"),l.a.createElement("th",null,"Reason"),l.a.createElement("th",null,"Date Flagged"),l.a.createElement("th",null,"Actions"))),l.a.createElement("tbody",null,this.state.flags.map(function(e){var t=e.user,a=e.observation;return l.a.createElement("tr",{key:e.id},l.a.createElement("td",{className:"table-thumbnail-container"},l.a.createElement("img",{src:a.thumbnail,alt:a.observation_category,className:"table-thumbnail is-rounded"})),l.a.createElement("td",null,l.a.createElement("p",null,l.a.createElement("a",{href:"/observation/"+a.id},l.a.createElement("strong",null,a.observation_category))),l.a.createElement("p",null,l.a.createElement("strong",null,"Uploaded by")," ",l.a.createElement(r.b,{to:"/user/"+a.user.id},a.user.name)),l.a.createElement("p",null,l.a.createElement("strong",null,"Flagged by")," ",l.a.createElement(r.b,{to:"/user/"+t.id},t.name))),l.a.createElement("td",null,l.a.createElement("p",null,e.reason),e.comments?l.a.createElement("div",null,l.a.createElement("p",null,l.a.createElement("strong",null,"User Comments")),l.a.createElement("p",null,e.comments)):null),l.a.createElement("td",null,e.created_at),l.a.createElement("td",null))})))}},{key:"renderPaginator",value:function(){var e=this;return l.a.createElement("nav",{className:"pagination is-centered",role:"navigation","aria-label":"pagination"},l.a.createElement("button",{type:"button",className:"pagination-previous",disabled:this.state.page<=1||this.state.loading,onClick:function(){return e.back()}},"Previous"),l.a.createElement("button",{type:"button",className:"pagination-next",disabled:!this.state.has_more_pages||this.state.loading,onClick:function(){return e.next()}},"Next"))}},{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement("div",{className:"columns is-marginless"},l.a.createElement("div",{className:"column"},l.a.createElement("h1",{className:"title is-3"},"Flagged Observations")),l.a.createElement("div",{className:"column has-text-right"},this.state.total," flags found. Page ",this.state.page," of ",Math.ceil(this.state.total/this.state.per_page))),l.a.createElement("div",{className:"box"},0!==this.state.total||this.state.loading?null:l.a.createElement("p",null,"There are no flagged observations."),this.renderTable(),this.renderPaginator()))}}]),t}();t.default=s}});