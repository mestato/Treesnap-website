webpackJsonp([20],{DakW:function(e,t,r){"use strict";var n=r("GiK3");r.n(n);var a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return window.ga&&setTimeout(function(){return window.ga("send","pageview")},2500),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,n["Component"]),t}();t.a=a},SldL:function(e,t,r){(function(t,r){!function(t){"use strict";var n,a=Object.prototype,o=a.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",c=i.toStringTag||"@@toStringTag",l="object"==typeof e,u=t.regeneratorRuntime;if(u)l&&(e.exports=u);else{(u=t.regeneratorRuntime=l?e.exports:{}).wrap=w;var f="suspendedStart",h="suspendedYield",p="executing",m="completed",d={},y={};y[s]=function(){return this};var g=Object.getPrototypeOf,v=g&&g(g(T([])));v&&v!==a&&o.call(v,s)&&(y=v);var b=N.prototype=x.prototype=Object.create(y);_.prototype=b.constructor=N,N.constructor=_,N[c]=_.displayName="GeneratorFunction",u.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},u.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,N):(e.__proto__=N,c in e||(e[c]="GeneratorFunction")),e.prototype=Object.create(b),e},u.awrap=function(e){return{__await:e}},j(k.prototype),u.AsyncIterator=k,u.async=function(e,t,r,n){var a=new k(w(e,t,r,n));return u.isGeneratorFunction(t)?a:a.next().then(function(e){return e.done?e.value:a.next()})},j(b),b[c]="Generator",b.toString=function(){return"[object Generator]"},u.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},u.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,a){return s.type="throw",s.arg=e,t.next=r,a&&(t.method="next",t.arg=n),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=o.call(i,"catchLoc"),l=o.call(i,"finallyLoc");if(c&&l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;S(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=n),d}}}function w(e,t,r,n){var a=t&&t.prototype instanceof x?t:x,o=Object.create(a.prototype),i=new L(n||[]);return o._invoke=function(e,t,r){var n=f;return function(a,o){if(n===p)throw new Error("Generator is already running");if(n===m){if("throw"===a)throw o;return R()}for(r.method=a,r.arg=o;;){var i=r.delegate;if(i){var s=O(i,r);if(s){if(s===d)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===f)throw n=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=p;var c=E(e,t,r);if("normal"===c.type){if(n=r.done?m:h,c.arg===d)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=m,r.method="throw",r.arg=c.arg)}}}(e,r,i),o}function E(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}function x(){}function _(){}function N(){}function j(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function k(e){function t(r,n,a,i){var s=E(e[r],e,n);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==typeof l&&o.call(l,"__await")?Promise.resolve(l.__await).then(function(e){t("next",e,a,i)},function(e){t("throw",e,a,i)}):Promise.resolve(l).then(function(e){c.value=e,a(c)},i)}i(s.arg)}var n;"object"==typeof r&&r.domain&&(t=r.domain.bind(t)),this._invoke=function(e,r){function a(){return new Promise(function(n,a){t(e,r,n,a)})}return n=n?n.then(a,a):a()}}function O(e,t){var r=e.iterator[t.method];if(r===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,O(e,t),"throw"===t.method))return d;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var a=E(r,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,d;var o=a.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function T(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function t(){for(;++r<e.length;)if(o.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return a.next=a}}return{next:R}}function R(){return{value:n,done:!0}}}("object"==typeof t?t:"object"==typeof window?window:"object"==typeof self?self:this)}).call(t,r("DuR2"),r("W2nU"))},WIBf:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("Xxa5"),a=r.n(n),o=r("GiK3"),i=r.n(o),s=r("F8kA"),c=r("saAw"),l=r("DakW"),u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.state={users:[],search:"",page:1,last_page:!1,total:0,loading:!0,showingFrom:0,showingTo:0,sortBy:"users.name",sortDirection:"asc",pages:[],loadingUsers:!0},document.title="Users - TreeSnap",r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l["a"]),u(t,[{key:"componentDidMount",value:function(){this.loadUsers()}},{key:"getParams",value:function(){var e=this.state;return{page:e.page,search:e.search,sort_by:e.sortBy,sort_dir:e.sortDirection}}},{key:"generatePages",value:function(e,t,r){var n=[],a=Math.ceil(e/t),o=Math.min(a,7),i=1;a>7&&r>3&&(n.push(1),n.push("..."),1===(i=r-3)&&i++);for(var s=i;s<Math.min(o+i,a+1);s++)n.push(s);return a>7&&r+3<a&&(n.push("..."),n.push(a)),n}},{key:"nextPage",value:function(){this.state.last_page||this.goToPage(this.state.page+1)}},{key:"prevPage",value:function(){1!==this.state.page&&this.goToPage(this.state.page-1)}},{key:"goToPage",value:function(e){this.setState({page:e,loadingUsers:!0},this.loadUsers)}},{key:"loadUsers",value:function(){var e,t=(e=a.a.mark(function e(){var t,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,axios.get("/admin/web/users",{params:this.getParams()});case 3:t=e.sent,r=t.data.data,this.setState({users:r.data,page:r.current_page,showingFrom:r.from,showingTo:r.to,last_page:r.last_page===r.page,total:r.total,pages:this.generatePages(r.total,r.per_page,r.current_page)}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:this.setState({loading:!1,loadingUsers:!1});case 12:case"end":return e.stop()}},e,this,[[0,8]])}),function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(a,o){try{var i=t[a](o),s=i.value}catch(e){return void r(e)}if(!i.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})});return function(){return t.apply(this,arguments)}}()},{key:"_renderRow",value:function(e,t){return i.a.createElement("tr",{key:t},i.a.createElement("td",null,i.a.createElement(s.b,{to:"/user/"+e.id},e.name)),i.a.createElement("td",null,e.email),i.a.createElement("td",null,e.observations_count),i.a.createElement("td",null,e.role.name))}},{key:"search",value:function(e){this.setState({search:e},this.loadUsers)}},{key:"renderSortIcon",value:function(e){return this.state.sortBy===e?"desc"===this.state.sortDirection?i.a.createElement("i",{className:"fa fa-sort-desc"}):i.a.createElement("i",{className:"fa fa-sort-asc"}):i.a.createElement("i",{className:"fa fa-sort"})}},{key:"sort",value:function(e){return this.setState({loadingUsers:!0}),e===this.state.sortBy?"asc"===this.state.sortDirection?this.setState({sortDirection:"desc"},this.loadUsers):this.setState({sortDirection:"asc"},this.loadUsers):this.setState({sortDirection:"asc",sortBy:e},this.loadUsers)}},{key:"renderTable",value:function(){var e=this;return 0!==this.state.users.length||this.state.loading?i.a.createElement("table",{className:"table is-striped mb-none"+(this.state.loadingUsers?" opacity-05":""),id:"users-table"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,i.a.createElement("a",{href:"javascript:;",onClick:function(){return e.sort("users.name")},className:"sortable-th flex-space-between is-flex"},"Name ",this.renderSortIcon("users.name"))),i.a.createElement("th",null,i.a.createElement("a",{onClick:function(){return e.sort("users.email")},href:"javascript:;",className:"sortable-th flex-space-between is-flex"},"Email ",this.renderSortIcon("users.email"))),i.a.createElement("th",null,i.a.createElement("a",{onClick:function(){return e.sort("observations_count")},href:"javascript:;",className:"sortable-th flex-space-between is-flex"},"Observations ",this.renderSortIcon("observations_count"))),i.a.createElement("th",null,i.a.createElement("a",{onClick:function(){return e.sort("roles.name")},href:"javascript:;",className:"sortable-th flex-space-between is-flex"},"Role ",this.renderSortIcon("roles.name"))))),i.a.createElement("tbody",null,this.state.users.map(this._renderRow.bind(this)))):i.a.createElement("p",null,"0 Users found")}},{key:"renderPagination",value:function(){var e=this,t=1===this.state.page,r=this.state.last_page;return i.a.createElement("nav",{className:"pagination is-centered mt-1"},i.a.createElement("button",{type:"button",className:"pagination-previous",disabled:t,onClick:this.prevPage.bind(this)},"Previous"),i.a.createElement("button",{type:"button",className:"pagination-next",disabled:r,onClick:this.nextPage.bind(this)},"Next page"),i.a.createElement("ul",{className:"pagination-list"},this.state.pages.map(function(t,r){return"..."===t?i.a.createElement("li",{key:"hellip_"+r},i.a.createElement("span",{className:"pagination-ellipsis"},"…")):i.a.createElement("li",{key:"page_"+t},i.a.createElement("a",{className:"pagination-link"+(e.state.page===t?" is-current":""),onClick:function(){e.state.page!==t&&e.goToPage.call(e,t)}},t))})))}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement("div",{className:"columns"},i.a.createElement("div",{className:"column"},i.a.createElement("h1",{className:"title is-3"},"Users")),i.a.createElement("div",{className:"column is-narrow has-text-right"},i.a.createElement("a",{href:"/admin/users/download",className:"button"},i.a.createElement("span",{className:"icon is-small"},i.a.createElement("i",{className:"fa fa-download"})),i.a.createElement("span",null,"Download")))),i.a.createElement("div",{className:"box"},i.a.createElement("div",{className:"columns"},i.a.createElement("div",{className:"column"},i.a.createElement("div",{className:"field"},i.a.createElement("div",{className:"control"},i.a.createElement("input",{type:"text",className:"input",name:"search",placeholder:"Search",value:this.state.search,onChange:function(t){var r=t.target;return e.search(r.value)}})))),i.a.createElement("div",{className:"column has-text-right"},this.state.total," Total Users. Showing ",this.state.showingFrom," to ",this.state.showingTo)),this.renderTable(),this.renderPagination()),i.a.createElement(c.a,{visible:this.state.loading}))}}]),t}();t.default=f},Xxa5:function(e,t,r){e.exports=r("jyFz")},jyFz:function(e,t,r){(function(t){var n="object"==typeof t?t:"object"==typeof window?window:"object"==typeof self?self:this,a=n.regeneratorRuntime&&Object.getOwnPropertyNames(n).indexOf("regeneratorRuntime")>=0,o=a&&n.regeneratorRuntime;if(n.regeneratorRuntime=void 0,e.exports=r("SldL"),a)n.regeneratorRuntime=o;else try{delete n.regeneratorRuntime}catch(e){n.regeneratorRuntime=void 0}}).call(t,r("DuR2"))},saAw:function(e,t,r){"use strict";var n=r("GiK3"),a=r.n(n),o=r("KSGD"),i=r.n(o),s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var c=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,n["Component"]),s(t,[{key:"render",value:function(){return this.props.visible?this.props.inline?a.a.createElement("div",{className:"mt-1",style:this.props.containerStyle},a.a.createElement("i",{className:"fa fa-refresh fa-spin fa-2x"})):a.a.createElement("div",{className:"spinner-overlay",style:this.props.containerStyle},a.a.createElement("div",{className:"overlay-blur"}),a.a.createElement("span",{className:"spinner-container"},a.a.createElement("i",{className:"is-loading"}))):null}}]),t}();t.a=c,c.propTypes={visible:i.a.bool.isRequired,containerStyle:i.a.object,inline:i.a.bool},c.defaultProps={containerStyle:{},inline:!1}}});